[{"name":"/Start Page","nodes":[{"id":"a4b7e4d4-c01d-1267-30b6-c2b448b90067","type":"Page","parameters":{"urlPath":"give"},"ports":[],"children":[{"id":"e302ebfd-6b8a-7c02-6e46-d93229019f88","type":"Text","parameters":{},"ports":[],"children":[]},{"id":"d9de89d3-58bf-374c-3829-c84da06d401d","type":"Text","parameters":{},"ports":[],"children":[]},{"id":"3fedfea0-b02c-8c35-46da-08fb13f548e4","type":"Text","parameters":{},"ports":[],"children":[]},{"id":"381c8fba-4734-29ae-461e-3b39cbb22f75","type":"For Each","parameters":{},"ports":[],"children":[]}]},{"id":"10fa011a-db2f-e573-47e6-ed69e091fbc1","type":"PageInputs","parameters":{"pathParams":"code,org","queryParams":"org1,code1"},"ports":[],"children":[]},{"id":"1c624894-9e72-6027-d2ab-958d4a66017e","type":"JavaScriptFunction","parameters":{"functionScript":"\nconst query = Noodl.Records.query;\nconst org = Inputs.org;\nconst code = Inputs.code;\n\nif (!org || !code) return;\n\ntry {\n  const results = await query(\"qr_codes\", {\n    and: [\n      { name: { equalTo: code } },\n      { organisation: {\n        relatedTo: {\n          id: org,\n          key: \"shortcode\"\n        }\n      }}\n    ]\n  }, {\n    select: \"id,products\",\n    include: \"products\"\n  });\n\n  Outputs.id = results[0].id;\n  Outputs.products = results[0].products.map(product => product.objectId);\n\n  if (results[0].products.length === 1) {\n    Outputs.single = true;\n  } else {\n    Outputs.single = false;\n  }\n\n  Outputs.Success();\n} catch (error) {\n  console.error(\"Error:\", error);\n  Outputs.Failure();\n  Outputs.error = error\n}\n"},"ports":[{"name":"in-org","displayName":"org","plug":"input","type":"*","group":"Inputs","index":4},{"name":"in-code","displayName":"code","plug":"input","type":"*","group":"Inputs","index":5},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":6},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":7},{"name":"out-id","displayName":"id","plug":"output","type":"*","group":"Outputs","index":8},{"name":"out-products","displayName":"products","plug":"output","type":"*","group":"Outputs","index":9},{"name":"out-single","displayName":"single","plug":"output","type":"*","group":"Outputs","index":10},{"name":"out-error","displayName":"error","plug":"output","type":"*","group":"Outputs","index":11}],"children":[]},{"id":"eb673a94-d4e8-3755-eb7c-e110e42530b9","type":"DbModel2","parameters":{"collectionName":"qr_codes"},"ports":[],"children":[]},{"id":"805fc1be-427d-1de6-70a0-8fbc0a431424","type":"DbCollection2","parameters":{"collectionName":"test","visualFilter":{"combinator":"or","rules":[{"combinator":"and","rules":[{"property":"name","operator":"equal to"}]}]}},"ports":[],"children":[]},{"id":"5a1e3be2-7a56-cc78-d386-b1d96c71102c","type":"DbCollection2","parameters":{"collectionName":"test","visualFilter":{"combinator":"or","rules":[{"combinator":"and","rules":[{"property":"name","value":"asfd","operator":"equal to"}]}]}},"ports":[],"children":[]}],"connections":[{"sourceId":"eb673a94-d4e8-3755-eb7c-e110e42530b9","sourcePort":"prop-member","targetId":"e302ebfd-6b8a-7c02-6e46-d93229019f88","targetPort":"text"},{"sourceId":"eb673a94-d4e8-3755-eb7c-e110e42530b9","sourcePort":"prop-organisation","targetId":"d9de89d3-58bf-374c-3829-c84da06d401d","targetPort":"text"},{"sourceId":"eb673a94-d4e8-3755-eb7c-e110e42530b9","sourcePort":"prop-name","targetId":"3fedfea0-b02c-8c35-46da-08fb13f548e4","targetPort":"text"},{"sourceId":"a4b7e4d4-c01d-1267-30b6-c2b448b90067","sourcePort":"didMount","targetId":"1c624894-9e72-6027-d2ab-958d4a66017e","targetPort":"run"},{"sourceId":"1c624894-9e72-6027-d2ab-958d4a66017e","sourcePort":"out-Success","targetId":"eb673a94-d4e8-3755-eb7c-e110e42530b9","targetPort":"fetch"},{"sourceId":"1c624894-9e72-6027-d2ab-958d4a66017e","sourcePort":"out-id","targetId":"eb673a94-d4e8-3755-eb7c-e110e42530b9","targetPort":"modelId"},{"sourceId":"10fa011a-db2f-e573-47e6-ed69e091fbc1","sourcePort":"pm-code","targetId":"1c624894-9e72-6027-d2ab-958d4a66017e","targetPort":"in-code"},{"sourceId":"10fa011a-db2f-e573-47e6-ed69e091fbc1","sourcePort":"pm-org","targetId":"1c624894-9e72-6027-d2ab-958d4a66017e","targetPort":"in-org"}],"ports":[],"roots":["a4b7e4d4-c01d-1267-30b6-c2b448b90067"]}]